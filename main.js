(()=>{"use strict";class e{constructor(e,t,s){this._name=e.name,this._link=e.link,this._templateSelector=t,this._handleCardClick=s}_getTemplate(){return document.querySelector(this._templateSelector).content.querySelector(".element").cloneNode(!0)}generateCard(){return this._element=this._getTemplate(),this._picture=this._element.querySelector(".element__image"),this._likeBtn=this._element.querySelector(".element__button-like"),this._setEventListeners(),this._element.querySelector(".element__title").textContent=this._name,this._picture.src=this._link,this._picture.alt=this._name,this._element}_setEventListeners(){this._likeBtn.addEventListener("click",(()=>{this._handleLikeClick()})),this._element.querySelector(".element__button-delete").addEventListener("click",(()=>{this._handleDeleteClick()})),this._picture.addEventListener("click",(()=>{this._handleCardClick({name:this._name,link:this._link})}))}_handleLikeClick(){this._likeBtn.classList.toggle("element__button-like_active")}_handleDeleteClick(){this._element.remove()}}class t{constructor(e,t){this._config=e,this._form=t}_showInputError(e){const t=this._form.querySelector(`.${e.id}-error`);e.classList.add(this._config.inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._config.errorClass)}_hideInputError(e){const t=this._form.querySelector(`.${e.id}-error`);e.classList.remove(this._config.inputErrorClass),t.classList.remove(this._config.errorClass),t.textContent=""}_setEventListeners(){this._inputsList=Array.from(this._form.querySelectorAll(this._config.inputSelector)),this._buttonElement=this._form.querySelector(this._config.submitButtonSelector),this._toggleButtonState(),this._inputsList.forEach((e=>{e.addEventListener("input",(()=>{this._toggleInputError(e),this._toggleButtonState()}))}))}_hasInvalidInput(){return this._inputsList.some((e=>!e.validity.valid))}_toggleInputError(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}activeSubmitButton(){this._buttonElement.classList.remove(this._config.inactiveButtonClass),this._buttonElement.disabled=!1}disabledSubmitButton(){this._buttonElement.classList.add(this._config.inactiveButtonClass),this._buttonElement.disabled=!0}_toggleButtonState(){this._hasInvalidInput()?this.disabledSubmitButton():this.activeSubmitButton()}cleanFormErrors(){this._errors=this._form.querySelectorAll(`.${this._config.errorClass}`),this._errors.forEach((e=>{e.classList.remove(this._config.errorClass)})),this._inputErrors=this._form.querySelectorAll(`.${this._config.inputErrorClass}`),this._inputErrors.forEach((e=>{e.classList.remove(this._config.inputErrorClass)}))}enableValidation(){this._setEventListeners()}}class s{constructor(e){this._popup=document.querySelector(e)}open(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popup.addEventListener("click",(e=>{(e.target.classList.contains("popup__close-button")||e.target===e.currentTarget)&&this.close()}))}}class n extends s{constructor(e,t){super(e),this._handleSubmitForm=t,this._popup=document.querySelector(e),this._popupForm=this._popup.querySelector(".popup__form"),this._inputsList=this._popupForm.querySelectorAll(".popup__input")}_getInputValues(){const e={};return this._inputsList.forEach((t=>{e[t.name]=t.value})),e}setInputValues(e){this._inputsList.forEach((t=>{t.value=e[t.name]}))}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleSubmitForm(this._getInputValues()),this.close()}))}close(){super.close(),this._popupForm.reset()}}const i=document.querySelector(".profile__edit-button"),r=document.querySelector(".profile__add-button"),o=(document.querySelector(".popup__input_value_name"),document.querySelector(".popup__input_value_description"),document.querySelector(".popup__form-profile")),l=document.querySelector(".popup-add-card__form"),p=(document.querySelector(".popup__input_value_title"),document.querySelector(".popup__input_value_link"),document.querySelector(".popup__save-button")),c={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__save-button",inactiveButtonClass:"popup__save-button_inactive",inputErrorClass:"form__input_type_error",errorClass:"form__input-error_active"},u=t=>new e(t,".element-template",f).generateCard(),a=new class{constructor({renderer:e},t){this.renderer=e,this._container=document.querySelector(t)}renderItems(e){this._items=e,this._items.forEach((e=>{this.renderer(e)}))}addItem(e){this._container.prepend(e)}}({renderer:e=>{const t=u(e);a.addItem(t)}},".elements");a.renderItems([{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Нью-Йорк",link:"https://images.unsplash.com/photo-1500916434205-0c77489c6cf7?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=687&q=80"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Лос-Анджелес",link:"https://images.unsplash.com/photo-1618374786896-d4985e2df9a6?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=687&q=80"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}]);const _=new n(".popup-add-card",(e=>{const t=u(e);a.addItem(t),_.close(),S.disabledSubmitButton()}));_.setEventListeners(),r.addEventListener("click",(function(){S.cleanFormErrors(),v.disabledSubmitButton(p),_.open()}));const d=new class{constructor({nameSelector:e,descriptionSelector:t}){this._profileName=document.querySelector(e),this._profileDescription=document.querySelector(t)}getUserInfo(){return{name:this._profileName.textContent,description:this._profileDescription.textContent}}setUserInfo(e){this._profileName.textContent=e.name,this._profileDescription.textContent=e.description}}({nameSelector:".profile__name",descriptionSelector:".profile__description"}),h=new n(".profile-popup",(e=>{d.setUserInfo(e)}));h.setEventListeners(),i.addEventListener("click",(()=>{h.setInputValues(d.getUserInfo()),v.cleanFormErrors(),h.open()}));const m=new class extends s{constructor(e){super(e),this.popupOpenPicture=document.querySelector(".popup-picture__image"),this.popupOpenTitle=document.querySelector(".popup-picture__title")}open(e,t){this.popupOpenPicture.src=t,this.popupOpenPicture.alt=e,this.popupOpenTitle.textContent=e,super.open()}}(".popup-picture");function f({name:e,link:t}){m.open(e,t)}m.setEventListeners();const v=new t(c,o),S=new t(c,l);v.enableValidation(),S.enableValidation()})();